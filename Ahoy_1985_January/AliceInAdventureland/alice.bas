5 REM ALICE
10 POKE53280,0:POKE53281,0:PRINT"[CLEAR][c 1]":FORI=1TO7:PRINT:NEXT
15 PRINTTAB(15)"[s U][s I][c A] [c R][s U][s I][c A][c S]":PRINTTAB(15)"[c Q][c W][s -] [s -][s -] [c Q]":PRINTTAB(15)"[c X][c Z][c Z][c X][c E][s J][s K][c Z][c X]"
17 PRINT:PRINTTAB(15)"BY SPIRKO":SE=54272:POKESE+24,15
20 DIMR$(5,5,5),PX(12),PY(12),SP(12),K$(12),A(15),B(15),C(15)
30 DEFFNR(R)=S(0)+S(1)+S(2)+S(3)+S(4)+S(5)+S(6)+S(7):OO=INT(14*RND(0))+1
35 FORI=1TO6:SP(I+6)=2+2*I:NEXT
40 GOSUB1700:GOSUB2000:DEFFNX(R)=R(3)+R(4)+R(6)+R(7)
47 FORI=0TO5:READL$(I):NEXT:FORI=1TO4:READDR$(I):NEXT
48 FORI=1TO4:READQ$(I):NEXT
50 G1=1472:G2=1730
55 FORI=1TO12:READPX(I),PY(I):NEXT:FORI=7TO12:READK$(I):NEXT
60 FORI=1TO15:READA(I),B(I),C(I):NEXT:FORI=1TO3:READJ,ST$(J):NEXT
61 FORZ=0TO5:FORY=0TO5:FORX=0TO5:READR$(X,Y,Z):L=ASC(LEFT$(R$(X,Y,Z),1))
62 IFL>77ANDL<84THENGOSUB1500
64 NEXTX,Y,Z:X=4:Y=5:Z=0
65 PRINT"[CLEAR][c 8]":PRINT:PRINT:PRINT"IS THIS A[c M][RVSON]N[RVSOFF]EW GAME OR A[c M][RVSON]C[RVSOFF]ONTINUATION?"
66 GETA$:IFA$=""THEN66
67 IFA$="C"THEN700
69 PRINT"[CLEAR]":PRINT:PRINT:PRINTTAB(12)"[CYAN]RIGHT  [c N][RVSON]>[RVSOFF][c H]"
70 PRINTTAB(12)"LEFT[3" "][c M][RVSON]<[RVSOFF][c G]":PRINTTAB(12)"UP[5" "][c M][RVSON]X[RVSOFF][c G]"
71 PRINTTAB(12)"DOWN[3" "][c N][RVSON]Z[RVSOFF][c G]":PRINTTAB(12)"QUIT[3" "][c M][RVSON]F1[RVSOFF][c G]"
72 PRINTTAB(12)"YES[4" "][c N][RVSON]SPACE[RVSOFF][c H]":PRINTTAB(12)"NO[6" "]ANY KEY"
80 PRINT:PRINT:PRINT:PRINT:PRINTTAB(11)"[c 8][c N][RVSON]F1[RVSOFF][c H] SLOW"
81 PRINTTAB(11)"[c N][RVSON]F3[RVSOFF][c G] MEDIUM":PRINTTAB(11)"[c N][RVSON]F5[RVSOFF][c G] FAST"
85 PRINT:PRINTTAB(12)"[c 8]WHAT SPEED? [c 3]";
86 PRINT"[s V][LEFT]";:GETA$:PRINT"[s +][LEFT]";:IFA$=""THEN86
87 IFA$="[F1]"THENSP=4:GOTO90
88 IFA$="[F3]"THENSP=5:GOTO90
89 SP=7
90 FORH=1TO4:READL:FORI=LTOL+62:READJ:POKEI,J:NEXTI,H
100 PRINT"[CLEAR][c 1][DOWN][DOWN][RIGHT][RIGHT][RVSON][c E][s +][s +][c R][c E][c W][RVSOFF][4" "][RVSON][c Q][c E][s +][c R][c E][s +]"
101 PRINT"[RVSON][RIGHT][RIGHT][s +][DOWN][LEFT][c R][DOWN][LEFT][c Q][DOWN][LEFT][s +][DOWN][LEFT][c E][DOWN][LEFT][c W][DOWN][LEFT][s +][DOWN][LEFT][c Q][DOWN][LEFT][s -][DOWN][LEFT][c R][DOWN][LEFT][s +][DOWN][LEFT][c E][DOWN][LEFT][c Q][DOWN][LEFT][s +][DOWN][LEFT][c Z]";
102 PRINT"[RVSON][LEFT][c W][s +][c E][s +][c W][c W][c E][s *][c E][c R][c Q][c R][c E][s +][c X]";
103 PRINT"[s +][UP][LEFT][c R][UP][LEFT][s +][UP][LEFT][c Q][UP][LEFT][c E][UP][LEFT][c R][UP][LEFT][c W][UP][LEFT][s +][UP][LEFT][s -][UP][LEFT][c Q][UP][LEFT][c E][UP][LEFT][c Q][UP][LEFT][s +][UP][LEFT][c E][UP][LEFT][s +][UP][LEFT]"
105 V=53248:V2=V+2:V3=V+3:VC=V+31:POKEV+37,1:POKEV+38,10
115 S(1)=2:POKE2041,13:POKEV+28,3:POKEV+40,14
116 POKEV+2,PX(5):POKEV+3,PY(5):FORI=1TO1500:NEXT
120 POKEV+41,10:POKE2042,14:POKEV+42,5:POKE2043,14
130 POKEV+43,4:POKE2044,14:POKEV+44,14:POKE2045,14
135 POKEV+45,7:POKE2046,14:POKE2047,14:POKEV+46,1
217 LP$="[c 8][HOME][DOWN][34"[RIGHT]"]"
220 PRINT"[HOME][5"[DOWN]"][YELLOW]"TAB(26)"MAP[4" "]LEVEL"
222 QP$="[HOME][DOWN][26"[RIGHT]"][WHITE]"
224 PRINTQP$"[GREEN][UP][3"[c @]"][DOWN][4"[LEFT]"][c N][3"[RIGHT]"][c H][DOWN][5"[LEFT]"][c N][3"[RIGHT]"][c H][DOWN][5"[LEFT]"][c M][3"[RIGHT]"][c G][DOWN][4"[LEFT]"][4"[c T]"]"
225 SP$="[HOME][22"[DOWN]"][CYAN]"
226 PRINT"[HOME][8"[DOWN]"]"TAB(26);:GOSUB230
228 PRINT"[HOME][12"[DOWN]"]"TAB(26);:GOSUB230:GOTO250
230 PRINT"[c 5][c A][s *][s *][c S][c A][s *][s *][c S][c A][s *][s *][c S][DOWN][12"[LEFT]"][s -]  [s -][s -]  [s -][s -]  [s -][DOWN][12"[LEFT]"][s -]  [s -][s -]  [s -][s -]  [s -]";
232 PRINT"[DOWN][12"[LEFT]"][c Z][s *][s *][c X][c Z][s *][s *][c X][c Z][s *][s *][c X]":RETURN
250 PRINT"[DOWN][YELLOW]"TAB(22)"GOLD":LC=54272
260 IFGS>0THENFORI=1TOGS:POKEG2+I,81:POKEG2+I+LC,7:NEXT
300 ER$="[38" "]":ER$=SP$+ER$+ER$
440 AX=PX(5):AY=PY(5):POKEV+21,FNR(R):POKEV+16,FNX(R)
450 FORE=7TO12:IFS(E-5)>0THENPOKEV+SP(E),PX(E):POKEV+SP(E)+1,PY(E)
460 NEXT
500 PRINTER$:GOSUB1100:GOSUB1200:IFSK=0THENGOSUB600
502 IFSK=1THEN510
505 GOSUB1000
510 SK=0:PRINTER$:S(1)=0:S(0)=0:POKEV+21,FNR(R):GOSUB1400
515 GOSUB1300:IFND=0THEN500
520 K=ND-(ND<3)*2+(ND>2)*2:AX=PX(K):AY=PY(K)
530 AX=PX(K):AY=PY(K):Y=Y+(ND=1)-(ND=3):X=X-(ND=2)+(ND=4):GOTO500
600 S(1)=2:POKEV2,AX:POKEV3,AY:POKEV+21,FNR(R)
610 FORI=1TO24STEP2:NX=I*(ND=4)-I*(ND=2):NY=I*(ND=1)-I*(ND=3)
620 POKEV2,AX+NX:POKEV3,AY+NY:NEXT
625 AX=NX+AX:AY=AY+NY:RETURN
700 PRINT:PRINT:PRINT"ARE YOU USING [RVSON]T[RVSOFF]APE OR [RVSON]D[RVSOFF]ISK?"
702 GETB1$:ON -(B1$="")GOTO702:IFB1$="D"THENB1=2:GOTO760
704 B1=1:PRINT"[CLEAR]"
708 PRINT:PRINT:PRINT"LOAD CONTINUATION":PRINT
710 OPEN1,1,0,"CONTINUATION"
720 INPUT#B1,SP,OO,GS,X,Y,Z,R(3),R(4),R(6),R(7)
730 FORI=2TO7:INPUT#B1,S(I):NEXT
735 FORI=2TO7:INPUT#B1,D$(I):NEXT
740 FORC=0TO5:FORB=0TO5:FORA=0TO5:INPUT#B1,R$(A,B,C):NEXTA,B,C
750 CLOSEB1:IFB1=1THEN:GOTO90
752 OPEN15,8,15:INPUT#15,E1$,E2$,E3$,E4$:CLOSE15:E1=VAL(E1$):IFE1<20THENGOTO90
754 PRINT"[CLEAR][DOWN][DOWN]DISK ERROR":PRINTE1$,E2$,E3$,E4$:END
760 PRINT:PRINT"LOADING PLEASE WAIT[4"."]"
762 OPEN2,8,2,"0:CONTINUATION,S,R":GOTO720
800 POKEV+21,0:PRINT"[CLEAR][c 8]":PRINT:PRINT" DO YOU WISH TO"
801 PRINT:PRINT"[c M][RVSON]C[RVSOFF]ONTINUE THIS GAME OR[c M][RVSON]N[RVSOFF]OT?":PRINT:PRINT
805 GETA$:IFA$=""THEN805
806 IFA$<>"C"THENEND
810 PRINT"SAVE TO [RVSON]T[RVSOFF]APE OR [RVSON]D[RVSOFF]ISK?":PRINT:PRINT
812 GETB1$:ON -(B1$="")GOTO812:IFB1$="D"THENB1=2:GOTO870
814 B1=1:PRINT"[CLEAR]"
820 PRINT"SAVE CONTINUATION":PRINT:PRINT
825 OPEN1,1,1,"CONTINUATION":C$=CHR$(13)
830 PRINT#B1,SP;C$;OO;C$;GS;C$;X;C$;Y;C$;Z
835 PRINT#B1,R(3);C$;R(4);C$;R(6);C$;R(7)
840 FORI=2TO7:PRINT#B1,S(I):NEXT
845 FORI=2TO7:PRINT#B1,D$(I):NEXT
850 FORC=0TO5:FORB=0TO5:FORA=0TO5:PRINT#B1,R$(A,B,C):NEXTA,B,C
860 PRINT#B1:CLOSEB1:IFB1=1THEN END
862 PRINT#15,"V":CLOSE15:END
870 PRINT:PRINT"SAVING TO DISK[4"."]"
872 OPEN15,8,15,"S0:CONTINUATION":OPEN2,8,2,"0:CONTINUATION,S,W":C$=CHR$(13)
874 GOTO830
1000 NY=0:NX=0:IFS(3)>0ORS(7)>0THENGOSUB1600
1005 P=PEEK(VC):IFP=2THEN1030
1008 GETM$:IFM$<>""THEN1040
1010 AY=AY+NY*ABS(P<>2):AX=AX+NX*ABS(P<>2):POKEV2,AX:POKEV3,AY
1015 ND=-(AY<65)-2*(AX>150)-3*(AY>175)-4*(AX<35):IFND>0THENRETURN
1020 GOTO1005
1030 AX=AX-NX:AY=AY-NY:POKEV2,AX:POKEV3,AY
1040 NY=SP*(M$="X")-SP*(M$="Z"):NX=SP*(M$=",")-SP*(M$=".")
1045 IFM$="[F1]"THEN800
1050 GOTO1010
1100 R$=R$(X,Y,Z):FORI=1TO4:PD(I)=VAL(MID$(R$,I+1,1))
1115 IF(S(3)>0ORS(7)>0)ANDI=KTHENPD(I)=1
1116 PRINTPD$(I);:ONPD(I)+1GOTO1120,1130,1140,1145
1120 PRINTWD$(I):GOTO1147
1130 PRINTOD$(I):GOTO1147
1140 PRINTGD$(I):GOTO1147
1145 PRINTSD$(I)
1147 NEXT:PRINTLP$;L$(Z)
1150 PRINTQP$SPC(X1);:Q$="":ONY1+1GOSUB1170,1180,1190
1151 X1=INT(X/2):Y1=INT(Y/2):X2=X-X1*2:Y2=Y-Y1*2
1152 QS=(X2=0ANDY2=0)+2*(X2=1ANDY2=0)+3*(X2=0ANDY2=1)+4*(X2=1ANDY2=1)
1160 Q$=Q$(ABS(QS))
1165 PRINTQP$SPC(X1);:ONY1+1GOSUB1170,1180,1190:RETURN
1170 PRINTQ$:RETURN
1180 PRINT"[DOWN]"Q$:RETURN
1190 PRINT"[DOWN][DOWN]"Q$:RETURN

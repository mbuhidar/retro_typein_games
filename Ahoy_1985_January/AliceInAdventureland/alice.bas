5 REM ALICE
10 POKE53280,0:POKE53281,0:PRINT"[CLEAR][c 1]":FORI=1TO7:PRINT:NEXT
15 PRINTTAB(15)"[s U][s I][c A] [c R][s U][s I][c A][c S]":PRINTTAB(15)"[c Q][c W][s -] [s -][s -] [c Q]":PRINTTAB(15)"[c X][c Z][c Z][c X][c E][s J][s K][c Z][c X]"
17 PRINT:PRINTTAB(15)"BY SPIRKO":SE=54272:POKESE+24,15
20 DIMR$(5,5,5),PX(12),PY(12),SP(12),K$(12),A(15),B(15),C(15)
30 DEFFNR(R)=S(0)+S(1)+S(2)+S(3)+S(4)+S(5)+S(6)+S(7):OO=INT(14*RND(0))+1
35 FORI=1TO6:SP(I+6)=2+2*I:NEXT
40 GOSUB1700:GOSUB2000:DEFFNX(R)=R(3)+R(4)+R(6)+R(7)
47 FORI=0TO5:READL$(I):NEXT:FORI=1TO4:READDR$(I):NEXT
48 FORI=1TO4:READQ$(I):NEXT
50 G1=1472:G2=1730
55 FORI=1TO12:READPX(I),PY(I):NEXT:FORI=7TO12:READK$(I):NEXT
60 FORI=1TO15:READA(I),B(I),C(I):NEXT:FORI=1TO3:READJ,ST$(J):NEXT
61 FORZ=0TO5:FORY=0TO5:FORX=0TO5:READR$(X,Y,Z):L=ASC(LEFT$(R$(X,Y,Z),1))
62 IFL>77ANDL<84THENGOSUB1500
64 NEXTX,Y,Z:X=4:Y=5:Z=0
65 PRINT"[CLEAR][c 8]":PRINT:PRINT:PRINT"IS THIS A[c M][RVSON]N[RVSOFF]EW GAME OR A[c M][RVSON]C[RVSOFF]ONTINUATION?"
66 GETA$:IFA$=""THEN66
67 IFA$="C"THEN700
69 PRINT"[CLEAR]":PRINT:PRINT:PRINTTAB(12)"[CYAN]RIGHT  [c N][RVSON]>[RVSOFF][c H]"
70 PRINTTAB(12)"LEFT[3" "][c M][RVSON]<[RVSOFF][c G]":PRINTTAB(12)"UP[5" "][c M][RVSON]X[RVSOFF][c G]"
71 PRINTTAB(12)"DOWN[3" "][c N][RVSON]Z[RVSOFF][c G]":PRINTTAB(12)"QUIT[3" "][c M][RVSON]F1[RVSOFF][c G]"
72 PRINTTAB(12)"YES[4" "][c N][RVSON]SPACE[RVSOFF][c H]":PRINTTAB(12)"NO[6" "]ANY KEY"
80 PRINT:PRINT:PRINT:PRINT:PRINTTAB(11)"[c 8][c N][RVSON]F1[RVSOFF][c H] SLOW"
81 PRINTTAB(11)"[c N][RVSON]F3[RVSOFF][c G] MEDIUM":PRINTTAB(11)"[c N][RVSON]F5[RVSOFF][c G] FAST"
85 PRINT:PRINTTAB(12)"[c 8]WHAT SPEED? [c 3]";
86 PRINT"[s V][LEFT]";:GETA$:PRINT"[s +][LEFT]";:IFA$=""THEN86
87 IFA$="[F1]"THENSP=4:GOTO90
88 IFA$="[F3]"THENSP=5:GOTO90
89 SP=7
90 FORH=1TO4:READL:FORI=LTOL+62:READJ:POKEI,J:NEXTI,H
100 PRINT"[CLEAR][c 1][DOWN][DOWN][RIGHT][RIGHT][RVSON][c E][s +][s +][c R][c E][c W][RVSOFF][4" "][RVSON][c Q][c E][s +][c R][c E][s +]"
101 PRINT"[RVSON][RIGHT][RIGHT][s +][DOWN][LEFT][c R][DOWN][LEFT][c Q][DOWN][LEFT][s +][DOWN][LEFT][c E][DOWN][LEFT][c W][DOWN][LEFT][s +][DOWN][LEFT][c Q][DOWN][LEFT][s -][DOWN][LEFT][c R][DOWN][LEFT][s +][DOWN][LEFT][c E][DOWN][LEFT][c Q][DOWN][LEFT][s +][DOWN][LEFT][c Z]";
102 PRINT"[RVSON][LEFT][c W][s +][c E][s +][c W][c W][c E][s *][c E][c R][c Q][c R][c E][s +][c X]";
103 PRINT"[s +][UP][LEFT][c R][UP][LEFT][s +][UP][LEFT][c Q][UP][LEFT][c E][UP][LEFT][c R][UP][LEFT][c W][UP][LEFT][s +][UP][LEFT][s -][UP][LEFT][c Q][UP][LEFT][c E][UP][LEFT][c Q][UP][LEFT][s +][UP][LEFT][c E][UP][LEFT][s +][UP][LEFT]"
105 V=53248:V2=V+2:V3=V+3:VC=V+31:POKEV+37,1:POKEV+38,10
115 S(1)=2:POKE2041,13:POKEV+28,3:POKEV+40,14
116 POKEV+2,PX(5):POKEV+3,PY(5):FORI=1TO1500:NEXT
120 POKEV+41,10:POKE2042,14:POKEV+42,5:POKE2043,14
130 POKEV+43,4:POKE2044,14:POKEV+44,14:POKE2045,14
135 POKEV+45,7:POKE2046,14:POKE2047,14:POKEV+46,1
217 LP$="[c 8][HOME][DOWN][34"[RIGHT]"]"
220 PRINT"[HOME][5"[DOWN]"][YELLOW]"TAB(26)"MAP[4" "]LEVEL"
222 QP$="[HOME][DOWN][26"[RIGHT]"][WHITE]"
224 PRINTQP$"[GREEN][UP][3"[c @]"][DOWN][4"[LEFT]"][c N][3"[RIGHT]"][c H][DOWN][5"[LEFT]"][c N][3"[RIGHT]"][c H][DOWN][5"[LEFT]"][c M][3"[RIGHT]"][c G][DOWN][4"[LEFT]"][4"[c T]"]"
225 SP$="[HOME][22"[DOWN]"][CYAN]"
226 PRINT"[HOME][8"[DOWN]"]"TAB(26);:GOSUB230
228 PRINT"[HOME][12"[DOWN]"]"TAB(26);:GOSUB230:GOTO250
230 PRINT"[c 5][c A][s *][s *][c S][c A][s *][s *][c S][c A][s *][s *][c S][DOWN][12"[LEFT]"][s -]  [s -][s -]  [s -][s -]  [s -][DOWN][12"[LEFT]"][s -]  [s -][s -]  [s -][s -]  [s -]";
232 PRINT"[DOWN][12"[LEFT]"][c Z][s *][s *][c X][c Z][s *][s *][c X][c Z][s *][s *][c X]":RETURN
250 PRINT"[DOWN][YELLOW]"TAB(22)"GOLD":LC=54272
260 IFGS>0THENFORI=1TOGS:POKEG2+I,81:POKEG2+I+LC,7:NEXT
300 ER$="[38" "]":ER$=SP$+ER$+ER$
440 AX=PX(5):AY=PY(5):POKEV+21,FNR(R):POKEV+16,FNX(R)
450 FORE=7TO12:IFS(E-5)>0THENPOKEV+SP(E),PX(E):POKEV+SP(E)+1,PY(E)
460 NEXT
500 PRINTER$:GOSUB1100:GOSUB1200:IFSK=0THENGOSUB600
502 IFSK=1THEN510
505 GOSUB1000
510 SK=0:PRINTER$:S(1)=0:S(0)=0:POKEV+21,FNR(R):GOSUB1400
515 GOSUB1300:IFND=0THEN500
520 K=ND-(ND<3)*2+(ND>2)*2:AX=PX(K):AY=PY(K)
530 AX=PX(K):AY=PY(K):Y=Y+(ND=1)-(ND=3):X=X-(ND=2)+(ND=4):GOTO500
600 S(1)=2:POKEV2,AX:POKEV3,AY:POKEV+21,FNR(R)
610 FORI=1TO24STEP2:NX=I*(ND=4)-I*(ND=2):NY=I*(ND=1)-I*(ND=3)
620 POKEV2,AX+NX:POKEV3,AY+NY:NEXT
625 AX=NX+AX:AY=AY+NY:RETURN
700 PRINT:PRINT:PRINT"ARE YOU USING [RVSON]T[RVSOFF]APE OR [RVSON]D[RVSOFF]ISK?"
702 GETB1$:ON -(B1$="")GOTO702:IFB1$="D"THENB1=2:GOTO760
704 B1=1:PRINT"[CLEAR]"
